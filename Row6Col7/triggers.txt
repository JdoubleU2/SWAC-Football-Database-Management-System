1. Update player's total touchdowns after new playerstats insert
 DELIMITER //
CREATE TRIGGER after_playerstats_insert
AFTER INSERT ON playerstats
FOR EACH ROW
BEGIN
   UPDATE player
   SET TotalTDs = COALESCE(TotalTDs, 0) + NEW.TDs
   WHERE PlayerID = NEW.PlayerID;
END//
DELIMITER ;

2. Prevent game date being set in the past on insert
  (after database is setup, we dont want old games from past to be added accidently 
      to keep the proper auditing and wrong scheduling) 
DELIMITER //
CREATE TRIGGER before_game_insert
BEFORE INSERT ON game
FOR EACH ROW
BEGIN
   IF NEW.Date < CURDATE() THEN
      SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Game date cannot be in the past';
   END IF;
END//
DELIMITER ;

3. Update team wins count after game result is updated
DELIMITER //
CREATE TRIGGER after_game_update
AFTER UPDATE ON game
FOR EACH ROW
BEGIN
  IF NEW.Result = 'HomeWin' THEN
     UPDATE team SET Wins = Wins + 1 WHERE TeamID = NEW.HomeTeamID;
  ELSEIF NEW.Result = 'AwayWin' THEN
     UPDATE team SET Wins = Wins + 1 WHERE TeamID = NEW.AwayTeamID;
  END IF;
END//
DELIMITER ;
