1. Procedure to update team's wins and losses by teamId
DELIMITER //
CREATE PROCEDURE UpdateTeamRecord(IN pTeamID INT)
BEGIN
  DECLARE winCount INT;
  DECLARE lossCount INT;
  
  SELECT COUNT(*) INTO winCount FROM game WHERE Result = 'HomeWin' AND HomeTeamID = pTeamID;
  SELECT COUNT(*) INTO lossCount FROM game WHERE Result = 'AwayWin' AND AwayTeamID = pTeamID;
  
  UPDATE team SET Wins = winCount, Losses = lossCount WHERE TeamID = pTeamID;
END//
DELIMITER ;

2. Function to calculate player efficiency rating

DELIMITER //
CREATE FUNCTION CalcPlayerEfficiency(pPlayerID INT) RETURNS DECIMAL(5,2)
BEGIN
  DECLARE eff DECIMAL(5,2);
  
  SELECT IFNULL(AVG((PassingYards + RushingYards + ReceivingYards) / NULLIF(GamesPlayed,0)),0)
  INTO eff
  FROM playerstats
  WHERE PlayerID = pPlayerID;
  
  RETURN eff;
END//
DELIMITER ;

3. Procedure to get total touchdowns by playerId
DELIMITER //
CREATE PROCEDURE GetPlayerTotalTDs(IN pPlayerID INT, OUT totalTDs INT)
BEGIN
  SELECT COALESCE(SUM(TDs),0) INTO totalTDs FROM playerstats WHERE PlayerID = pPlayerID;
END//
DELIMITER ;
